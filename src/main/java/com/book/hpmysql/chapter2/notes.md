# MySQL基准测试

## 为什么要基准测试
基准测试是唯一方便有效的，可以学习系统在给定条件的工作负载下会发生什么的方法。基准测试可以观察系统在不同压力下的行为，评估系统的容量，掌握那些是重要的变化，或者观察系统如何处理不同的数据。基准测试可以在系统实际负载之外创造一些虚构的场景进行测试。

基准测试可以完成以下工作，或者更多：
- 验证一些基于系统的假设，确认这些假设是否符合实际情况。
- 重现环境中的某些异常行为，以解决这些异常。
- 测试系统当前运行状况。
- 模拟比当前系统更高的负载，以找出系统随着压力增加而可能遇到的拓展性瓶颈。
- 规划未来的业务增长。
- 测试应用适应可变环境的能力。
- 测试不同的硬件、软件和操作系统的配置。
- 证明采购的新设备是否配置正确。

基准测试的一个主要问题在于其不是真实压力的测试。基准测试施加给系统的压力相对真实环境比较简单。真实压力是不可预期的且变化多端，有时候情况过于复杂而难以解释。所以使用真实压力测试，可能难以从结果中分析出确切的结论。

基准测试通常要求尽可能快的执行完成，所以经常给系统造成过大的压力。

## 基准测试的策略
基准测试有两种主要策略：一种是针对整个系统的整体测试，另一种是单独测试MySQL。这两种策略也被称为集成式以及单组件式基准测试。

针对系统做集成测试，而不是单独测试MySQL的原因有以下几点：
- 测试整个应用系统，包括web服务器，应用代码，网络和数据库是非常有用的，用户不仅仅关注MySQL本身的性能，而是整体应用的性能。
- MySQL并非总是应用的瓶颈。
- 只有进行整体测试才能发现，各个缓存之间带来的影响。
- 整体应用的集成测试更能揭示应用的真实性。

基于以下情况，可以选择只测试MySQL：
- 需要比较不同schema或查询的性能。
- 针对应用中的某个具体问题的测试。
- 通关短期的基准测试，来检测出某些调整后的效果。

### 测试什么指标
设计基准测试前，要明确测试目标。不同的测试目标决定了不同的测试工具和技术。

请考虑以下指标，看看如何满足测试的需求：
- 吞吐量：指的是单位时间内事务的处理数，这类基准测试主要针对在线事务处理（OLTP）的吞吐量，非常适用于多用户的交互式应用。常用的测试单位是每秒事务数（TPS），也有采用每分钟事务数（TPM）
- 响应时间或延迟：这个指标用于测试任务的整体时间。测试单位可能是微秒，毫秒，秒或者分钟，根据不同的时间单位计算出平均响应时间，最小响应时间与最大响应时间和所占百分比。
- 并发性：并发性基准测试关注的是正在工作中的并发操作，或者是同时工作中的线程数或者连接数。当并发数量增加时，需要测量吞吐量是否下降，响应时间是否变长。并发行的测量完全不同于响应时间和吞吐量。他不像是一个结果，而更像是设置基准测试的一个属性。并发测试通常不是为了测试应用能达到的并发数，而是在不同并发下的性能。
- 可拓展性：给系统增加一倍的工作，在理想情况下就能获得2倍的结果。或者给系统增加一倍的资源，就可以获得2倍的吞吐量。大多数系统无法做到如此理想化的线性拓展，随着压力的变化，吞吐量和性能可能会越来越差。可拓展性指标对于容量规范非常有用，帮助系统发现应用的瓶颈。




